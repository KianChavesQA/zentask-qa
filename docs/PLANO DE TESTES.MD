# üõ°Ô∏è Test Automation Plan | ZenTask QA
> **Project:** Bug Hunting & API Resilience  
> **Framework:** Playwright + Allure  
> **CI/CD:** GitHub Actions  
> **Status:** `DRAFT`

---

## üèóÔ∏è Arquitetura da Solu√ß√£o
A estrat√©gia foca no desacoplamento entre a l√≥gica de teste e a infraestrutura de relat√≥rios.

| Camada | Tecnologia | Finalidade |
| :--- | :--- | :--- |
| **Test Runner** | ![Playwright](https://img.shields.io/badge/Playwright-31AD52?style=flat-square&logo=Playwright&logoColor=white) | Execu√ß√£o de testes de API e paralelismo. |
| **Reporting** | ![Allure](https://img.shields.io/badge/Allure_Report-FFC107?style=flat-square&logo=allure&logoColor=black) | Dashboard t√©cnico e hist√≥rico de bugs. |
| **CI/CD** | ![GitHub Actions](https://img.shields.io/badge/GitHub_Actions-2088FF?style=flat-square&logo=github-actions&logoColor=white) | Pipeline de execu√ß√£o cont√≠nua. |

---

## üìä Matriz de Cen√°rios e Prioridades
Planeamento baseado nos requisitos de neg√≥cio e bugs conhecidos da v4.1.0.

| ID         | Cen√°rio de Teste            | Requisito | Severidade | Objetivo do Teste 
| :---       | :---                        | :---      | :---       | :---             
| **API-01** | Valida√ß√£o de Contrato `POST`| `US02`    | üü† Alta    | Validar se retorna `201` em vez de `200`. 
| **API-02** | Vazamento de Dados `secret` | `RN04`    | üî¥ Cr√≠tica | Garantir que dados sens√≠veis n√£o transitam no JSON. 
| **API-03** | Integridade da Exclus√£o     | `RN03`    | üü† Alta    | Confirmar que o `DELETE` remove o dado (Hard Delete). 
| **API-04** | Resili√™ncia de Estat√≠sticas | `RN05`    | üü° M√©dia   | Evitar `NaN` em c√°lculos com base de dados vazia. 
| **API-05** | Auth via Header Exclusivo   | `RN01`    | üî¥ Cr√≠tica | Bloquear acesso se a chave for enviada no Body. 

---

## üß† Conjecturas e Refuta√ß√µes de Engenharia

### üö© Refuta√ß√£o: O falso positivo do HTTP 204
> **Cen√°rio:** O endpoint `DELETE /v1/tasks/:id` responde com sucesso.
* **Conjectura:** O desenvolvedor pode estar a retornar `204` sem validar se o registro foi realmente removido (conflito de tipo `string` vs `number`).
* **Refuta√ß√£o:** O sucesso da transa√ß√£o HTTP n√£o garante a persist√™ncia.
* **Valida√ß√£o:** O teste deve realizar um `GET` ap√≥s a exclus√£o; o status retornado **deve** ser `404`.

### üö© Refuta√ß√£o: Broken Object Level Authorization (BOLA)
> **Cen√°rio:** Usu√°rio comum acede √† lista de usu√°rios.
* **Conjectura:** A API valida que o utilizador est√° autenticado, mas esquece-se de validar se ele tem permiss√£o para ver campos sens√≠veis de terceiros.
* **Refuta√ß√£o:** Autentica√ß√£o n√£o √© Autoriza√ß√£o.
* **Valida√ß√£o:** O teste deve falhar se o payload de um usu√°rio comum contiver o campo `secret`.

---

## üöÄ Integra√ß√£o Cont√≠nua (GitHub Actions)
Configura√ß√£o do workflow para execu√ß√£o em cada `push`.

```yaml
name: Playwright Tests & Allure Report
on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  test:
    timeout-minutes: 60
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4

    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: 18

    - name: Install dependencies
      run: npm ci

    - name: Install Playwright Browsers
      run: npx playwright install --with-deps

    - name: Run Playwright tests
      run: npx playwright test
      continue-on-error: true 

    - name: Get Allure history
      uses: actions/checkout@v4
      if: always()
      continue-on-error: true
      with:
        ref: gh-pages
        path: gh-pages

    - name: Allure Report action
      uses: simple-elf/allure-report-action@master
      if: always()
      with:
        allure_results: allure-results
        allure_history: allure-history
        keep_reports: 20

    - name: Deploy report to Github Pages
      if: always()
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: allure-history
        publish_branch: gh-pages